window.bill_actions={deleteBill:l=>{let i=document.querySelector('#deleteBillModal input[name="bill_id"]'),a=document.querySelector("#deleteBillModal [data-modal-message]");if(i){a&&(a.innerHTML=`Deseja realmente excluir o item <strong>${l}</strong>?`),i.value=l;try{jQuery("#showBillModal").modal("hide"),jQuery("#editBillModal").modal("hide")}catch(n){console.log(n)}jQuery("#deleteBillModal").modal("show"),$("#deleteBillModal").on("hidden.bs.modal",function(n){i.value="",a&&(a.innerHTML="")})}},editBill:l=>{if(!l){console.log("Error: Invalid billId",l);return}let i=document.querySelector(`[data-bill-row-id="${l}"]`);if(!i){console.log("Error: Invalid row",i);return}let a=document.querySelector('#editBillModal input[name="bill_id"]'),n=document.querySelector("#editBillModal [data-modal-message]");if(!a)return;a.value=l;let c=(()=>{try{return JSON.parse(i.dataset.billRowData)}catch(t){return console.error(t),null}})();if(!c){console.log("Error: invalid rowData",c);return}let u=[{selector:'select[name="status"]',key:"status"},{selector:'select[name="type"]',key:"type"},{selector:'input[name="title"]',key:"title"},{selector:'input[name="overdue_date"]',key:"overdue_date",formater:(t,e,o)=>{try{return new Date(e).toISOString().slice(0,10)}catch(r){return console.error("Error on overdue_date",r,"value:",e),e}}},{selector:'input[name="value"]',key:"value",formater:(t,e,o)=>(console.log(t,e),e)},{selector:'input[name="creditor_id"]',key:"creditor_id"},{selector:'input[data-null-name="creditor_name"]',key:"creditor",formater:(t,e,o)=>{if(!(!window.DotObject||!window.DotObject.get))return DotObject.get("name",e)}},{selector:'textarea[name="note"]',key:"note"}],s=(t=!1)=>{u.forEach(e=>{if(!e||!e.selector)return;let o=document.querySelector(e.selector);if(!o)return;let r=t||!e.key,w=e.formater,d=r?"":c[e.key];!r&&w&&(d=w(o,d,c)),o.value=d,o.dispatchEvent(new Event("change"))})};s(!0);try{jQuery("#showBillModal").modal("hide"),jQuery("#deleteBillModal").modal("hide")}catch(t){console.log(t)}jQuery("#editBillModal").on("show.bs.modal",function(t){a.value=l,s(),n&&(n.innerHTML=`Editando item <strong>#${l}</strong>`)}),jQuery("#editBillModal").on("hidden.bs.modal",function(t){a.value="",s(!0),n&&(n.innerHTML="")}),jQuery("#editBillModal").modal("show")},showBill:l=>{if(!l){console.log("Error: Invalid billId",l);return}let i=document.querySelector("#showBillModal");if(!i){console.log("Error: Invalid modalContainer",i);return}let a=document.querySelector(`[data-bill-row-id="${l}"]`);if(!a){console.log("Error: Invalid row",a);return}let n=(()=>{try{return JSON.parse(a.dataset.billRowData)}catch(t){return console.error(t),null}})();if(!n){console.log("Error: invalid rowData",n);return}let c=[{selector:'[data-show-name="id"]',key:"id"},{selector:'[data-show-name="status"]',key:"status",formater:(t,e,o)=>{try{if(!window.helpers||!window.helpers.lang||window.helpers.lang.constructor.name!="Function")return e;let r=`enums.status.${e}`;return window.helpers.lang(r,e)}catch{return e}}},{selector:'[data-show-name="type"]',key:"type",formater:(t,e,o)=>{try{if(!window.helpers||!window.helpers.lang||window.helpers.lang.constructor.name!="Function")return e;let r=`enums.type.${e}`;return window.helpers.lang(r,e)}catch{return e}}},{selector:'[data-show-name="title"]',key:"title"},{selector:'[data-show-name="overdue_date"]',key:"overdue_date",formater:(t,e,o)=>{try{return new Date(e).toISOString().slice(0,10)}catch(r){return console.error("Error on overdue_date",r,"value:",e),e}}},{selector:'[data-show-name="value"]',key:"value",formater:(t,e,o)=>e},{selector:'[data-show-name="creditor_id"]',key:"creditor_id"},{selector:'[data-show-name="creditor_name"]',key:"creditor",formater:(t,e,o)=>{try{let r=DotObject.get("name",e)||"";return!r||!window.DotObject||!window.DotObject.get?"":r}catch{return""}}},{selector:'[data-show-name="note"]',key:"note"},{selector:'[data-action-name="editBill"]',key:"id",noReplaceContent:!0,attributes:["data-action-info"]},{selector:'[data-action-name="deleteBill"]',key:"id",noReplaceContent:!0,attributes:["data-action-info"]}],u=(t=!1)=>{c.forEach(e=>{if(!e||!e.selector)return;let o=i.querySelectorAll(e.selector);if(!o||!o.length)return;let r=t||!e.key,w=e.formater,d=r?"":n[e.key];o.forEach(m=>{!r&&w&&(d=w(m,d,n));let y=e.attributes||[];!e.noReplaceContent&&e.isHtml&&(m.innerHTML=d),!e.noReplaceContent&&!e.isHtml&&(m.innerText=d),y&&y.constructor.name==="Array"&&y.length&&y.forEach(h=>{h&&m.setAttribute(h,d)}),m.dispatchEvent(new Event("change"))})})};u(!0);let s=document.querySelector("#showBillModal [data-modal-message]");jQuery("#showBillModal").on("show.bs.modal",function(t){u(),s&&(s.innerHTML=`Detalhes da conta <strong>#${l}</strong>`)}),jQuery("#showBillModal").on("hidden.bs.modal",function(t){u(!0),s&&(s.innerHTML="")}),jQuery("#showBillModal").modal("show")}};window.addEventListener("load",l=>{window.bill_actions&&window.deleteId&&window.bill_actions.deleteBill(window.deleteId),initSearch&&initSearch()});
